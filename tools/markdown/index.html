<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markdown编辑器 - 在线工具箱</title>
    <link rel="stylesheet" href="../../public/style.css">
    <link rel="stylesheet" href="tool.css">
    <!-- CodeMirror -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/markdown/markdown.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/xml/xml.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/javascript/javascript.min.js"></script>
    
    <!-- 基础库 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.0.6/purify.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked@11.1.1/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>
<body>
    <div class="page-wrapper">
        <main class="main">
            <section class="tool-page-hero">
                <div class="container">
                    <h1>Markdown编辑器</h1>
                    <p>在线Markdown编辑器，支持实时预览、语法高亮和多种导出格式</p>
                </div>
            </section>

            <div class="container">
                <div class="editor-container">
                    <div class="toolbar">
                        <div class="toolbar-group">
                            <button class="tool-btn" data-action="undo" title="撤销 (Ctrl+Z)">
                                <span class="iconify" data-icon="tabler:arrow-back-up" data-inline="false"></span>
                            </button>
                            <button class="tool-btn" data-action="redo" title="重做 (Ctrl+Y)">
                                <span class="iconify" data-icon="tabler:arrow-forward-up" data-inline="false"></span>
                            </button>
                        </div>
                        <span class="separator"></span>
                        <div class="toolbar-group">
                            <button class="tool-btn" data-action="bold" title="粗体 (Ctrl+B)">
                                <span class="iconify" data-icon="tabler:bold" data-inline="false"></span>
                            </button>
                            <button class="tool-btn" data-action="italic" title="斜体 (Ctrl+I)">
                                <span class="iconify" data-icon="tabler:italic" data-inline="false"></span>
                            </button>
                            <button class="tool-btn" data-action="strikethrough" title="删除线">
                                <span class="iconify" data-icon="tabler:strikethrough" data-inline="false"></span>
                            </button>
                        </div>
                        <span class="separator"></span>
                        <div class="toolbar-group">
                            <button class="tool-btn" data-action="heading" title="标题 (Ctrl+H)">
                                <span class="iconify" data-icon="tabler:heading" data-inline="false"></span>
                            </button>
                            <button class="tool-btn" data-action="quote" title="引用 (Ctrl+Q)">
                                <span class="iconify" data-icon="tabler:quote" data-inline="false"></span>
                            </button>
                            <button class="tool-btn" data-action="code" title="代码块 (Ctrl+K)">
                                <span class="iconify" data-icon="tabler:code" data-inline="false"></span>
                            </button>
                        </div>
                        <span class="separator"></span>
                        <div class="toolbar-group">
                            <button class="tool-btn" data-action="list-ul" title="无序列表">
                                <span class="iconify" data-icon="tabler:list" data-inline="false"></span>
                            </button>
                            <button class="tool-btn" data-action="list-ol" title="有序列表">
                                <span class="iconify" data-icon="tabler:list-numbers" data-inline="false"></span>
                            </button>
                            <button class="tool-btn" data-action="task" title="任务列表">
                                <span class="iconify" data-icon="tabler:checkbox" data-inline="false"></span>
                            </button>
                        </div>
                        <span class="separator"></span>
                        <div class="toolbar-group">
                            <button class="tool-btn" data-action="link" title="链接 (Ctrl+L)">
                                <span class="iconify" data-icon="tabler:link" data-inline="false"></span>
                            </button>
                            <button class="tool-btn" data-action="image" title="图片">
                                <span class="iconify" data-icon="tabler:photo" data-inline="false"></span>
                            </button>
                            <button class="tool-btn" data-action="table" title="表格">
                                <span class="iconify" data-icon="tabler:table" data-inline="false"></span>
                            </button>
                        </div>
                        <span class="separator"></span>
                        <div class="toolbar-group">
                            <button class="tool-btn" data-action="code-block" title="代码块">
                                <span class="iconify" data-icon="tabler:code-dots" data-inline="false"></span>
                            </button>
                            <button class="tool-btn" data-action="emoji" title="表情符号">
                                <span class="iconify" data-icon="tabler:mood-smile" data-inline="false"></span>
                            </button>
                        </div>
                        <span class="separator"></span>
                        <div class="toolbar-group">
                            <button class="tool-btn" data-format="md" title="导出为 Markdown">
                                <span class="iconify" data-icon="tabler:markdown" data-inline="false"></span>
                            </button>
                            <button class="tool-btn" data-format="html" title="导出为 HTML">
                                <span class="iconify" data-icon="tabler:file-type-html" data-inline="false"></span>
                            </button>
                            <button class="tool-btn" data-format="pdf" title="导出为 PDF">
                                <span class="iconify" data-icon="tabler:file-type-pdf" data-inline="false"></span>
                            </button>
                        </div>
                        <span class="separator"></span>
                        <div class="toolbar-group">
                            <button class="tool-btn" data-action="edit-only" title="纯编辑模式">
                                <span class="iconify" data-icon="tabler:edit" data-inline="false"></span>
                            </button>
                            <button class="tool-btn" data-action="preview" title="预览模式">
                                <span class="iconify" data-icon="tabler:eye" data-inline="false"></span>
                            </button>
                            <button class="tool-btn" data-action="fullscreen" title="全屏模式">
                                <span class="iconify" data-icon="tabler:maximize" data-inline="false"></span>
                            </button>
                            <button class="tool-btn" data-action="clear" title="清空内容">
                                <span class="iconify" data-icon="tabler:eraser" data-inline="false"></span>
                            </button>
                        </div>
                    </div>
                    
                    <input type="file" id="image-file-input" accept="image/*" style="display: none;">
                    
                    <div class="editor-wrapper">
                        <div class="editor-pane">
                            <div class="pane-title">编辑区</div>
                            <textarea id="markdown-editor"></textarea>
                            <div class="status-bar">
                                <span class="word-count">字数：0</span>
                                <span class="cursor-position">行：1，列：1</span>
                            </div>
                        </div>
                        <div class="preview-pane">
                            <div class="pane-title">预览区</div>
                            <div id="preview-content" class="markdown-body"></div>
                        </div>
                    </div>
                </div>

                <div class="tool-info">
                    <h2>功能说明</h2>
                    <p>这是一个专业的在线Markdown编辑器，为写作者提供了强大的编辑功能和直观的操作界面，让您的写作体验更加流畅。</p>
                    
                    <h3>主要功能</h3>
                    <ul>
                        <li>所见即所得的实时预览功能</li>
                        <li>智能语法高亮显示</li>
                        <li>完整支持标准Markdown语法</li>
                        <li>丰富的扩展语法（表格、任务列表、数学公式等）</li>
                        <li>便捷的快捷键操作系统</li>
                        <li>智能的自动保存功能</li>
                        <li>沉浸式的全屏编辑模式</li>
                        <li>支持导出为Markdown、HTML和PDF格式</li>
                        <li>支持图片上传和外链引用</li>
                    </ul>
                    
                    <h3>快捷键指南</h3>
                    <ul>
                        <li><kbd>Ctrl</kbd> + <kbd>B</kbd>：设置文本为粗体</li>
                        <li><kbd>Ctrl</kbd> + <kbd>I</kbd>：设置文本为斜体</li>
                        <li><kbd>Ctrl</kbd> + <kbd>K</kbd>：插入代码块</li>
                        <li><kbd>Ctrl</kbd> + <kbd>L</kbd>：插入超链接</li>
                        <li><kbd>Ctrl</kbd> + <kbd>H</kbd>：插入标题</li>
                        <li><kbd>Ctrl</kbd> + <kbd>Q</kbd>：插入引用块</li>
                        <li><kbd>Ctrl</kbd> + <kbd>Z</kbd>：撤销上一步操作</li>
                        <li><kbd>Ctrl</kbd> + <kbd>Y</kbd>：重做上一步操作</li>
                    </ul>
                </div>
            </div>
        </main>
    </div>

    <!-- 链接弹出层 -->
    <div id="link-popup" class="popup-overlay">
        <div class="popup-container">
            <div class="popup-header">
                <div class="popup-title">插入链接</div>
                <span class="iconify popup-close" data-icon="tabler:x" data-inline="false"></span>
            </div>
            <div class="popup-content">
                <div class="form-group">
                    <label for="link-text">链接文字</label>
                    <input type="text" id="link-text" class="form-control" placeholder="显示的文字">
                </div>
                <div class="form-group">
                    <label for="link-url">链接地址</label>
                    <input type="text" id="link-url" class="form-control" placeholder="https://">
                </div>
            </div>
            <div class="popup-footer">
                <button class="btn popup-close">取消</button>
                <button class="btn btn-primary" id="insert-link">插入</button>
            </div>
        </div>
    </div>

    <!-- 图片插入弹窗 -->
    <div id="image-insert-popup" class="popup-overlay">
        <div class="popup-container">
            <div class="popup-header">
                <div class="popup-title">插入图片</div>
                <span class="iconify popup-close" data-icon="tabler:x" data-inline="false"></span>
            </div>
            <div class="popup-content">
                <div class="btn-group">
                    <div class="btn-group-option active" data-type="upload">上传图片</div>
                    <div class="btn-group-option" data-type="link">图片链接</div>
                </div>
                
                <!-- 上传图片面板 -->
                <div class="panel active" id="upload-panel">
                    <div class="form-group">
                        <label for="upload-image-text">图片描述</label>
                        <input type="text" id="upload-image-text" class="form-control" placeholder="图片的替代文字">
                    </div>
                    <div class="upload-area">
                        <div class="drag-area" id="image-drag-area">
                            <span class="iconify" data-icon="tabler:upload"></span>
                            <p>拖拽图片到此处或点击上传</p>
                            <small>支持 JPG、PNG、GIF 等格式</small>
                        </div>
                        <input type="file" id="image-file-input" accept="image/*" style="display: none;">
                    </div>

                </div>
                
                <!-- 图片链接面板 -->
                <div class="panel" id="link-panel">
                    <div class="form-group">
                        <label for="link-image-text">图片描述</label>
                        <input type="text" id="link-image-text" class="form-control" placeholder="图片的替代文字">
                    </div>
                    <div class="form-group">
                        <label for="image-url">图片链接</label>
                        <input type="text" id="image-url" class="form-control" placeholder="https://">
                    </div>
                </div>
            </div>
            <div class="popup-footer">
                <button class="btn popup-close">取消</button>
                <button class="btn btn-primary" id="insert-image">插入</button>
            </div>
        </div>
    </div>

    <!-- 表格插入弹窗优化 -->
    <div id="table-popup" class="popup-overlay">
        <div class="popup-container">
            <div class="popup-header">
                <div class="popup-title">插入表格</div>
                <span class="iconify popup-close" data-icon="tabler:x" data-inline="false"></span>
            </div>
            <div class="popup-content">
                <div class="form-group">
                    <label>行数</label>
                    <input type="number" id="table-rows" value="3" min="1" max="20">
                </div>
                <div class="form-group">
                    <label>列数</label>
                    <input type="number" id="table-cols" value="3" min="1" max="20">
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="table-header" checked>
                        包含表头
                    </label>
                </div>
                <div class="form-group">
                    <label>对齐方式</label>
                    <div class="align-options">
                        <label class="align-option">
                            <input type="radio" name="align" value="left" checked>
                            <span class="iconify" data-icon="tabler:align-left"></span>
                        </label>
                        <label class="align-option">
                            <input type="radio" name="align" value="center">
                            <span class="iconify" data-icon="tabler:align-center"></span>
                        </label>
                        <label class="align-option">
                            <input type="radio" name="align" value="right">
                            <span class="iconify" data-icon="tabler:align-right"></span>
                        </label>
                    </div>
                </div>
            </div>
            <div class="popup-footer">
                <button class="btn popup-close">取消</button>
                <button class="btn btn-primary" id="insert-table">插入</button>
            </div>
        </div>
    </div>

    <!-- 代码块弹出层 -->
    <div id="code-block-popup" class="popup-overlay">
        <div class="popup-container">
            <div class="popup-header">
                <div class="popup-title">插入代码块</div>
                <span class="iconify popup-close" data-icon="tabler:x" data-inline="false"></span>
            </div>
            <div class="popup-content">
                <div class="form-group">
                    <label for="code-language">编程语言</label>
                    <select id="code-language" class="form-control">
                        <option value="plaintext">Plain Text</option>
                        <option value="javascript">JavaScript</option>
                        <option value="python">Python</option>
                        <option value="java">Java</option>
                        <option value="cpp">C++</option>
                        <option value="css">CSS</option>
                        <option value="html">HTML</option>
                        <option value="json">JSON</option>
                        <option value="markdown">Markdown</option>
                        <option value="sql">SQL</option>
                        <option value="xml">XML</option>
                        <option value="yaml">YAML</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="code-content">代码内容</label>
                    <textarea id="code-content" class="form-control" rows="8" placeholder="在此输入代码..."></textarea>
                </div>
            </div>
            <div class="popup-footer">
                <button class="btn popup-close">取消</button>
                <button class="btn btn-primary" id="insert-code-block">插入</button>
            </div>
        </div>
    </div>

    <!-- 表情符号弹出层 -->
    <div id="emoji-popup" class="popup-overlay">
        <div class="popup-container">
            <div class="popup-header">
                <div class="popup-title">插入表情符号</div>
                <span class="iconify popup-close" data-icon="tabler:x" data-inline="false"></span>
            </div>
            <div class="popup-content">
                <div class="form-group">
                    <input type="text" id="emoji-search" class="form-control" placeholder="搜索表情符号...">
                </div>
                <div class="emoji-grid" id="emoji-grid">
                    <!-- 表情符号将通过JavaScript动态加载 -->
                </div>
            </div>
        </div>
    </div>



    <script src="../../public/main.js"></script>
    <script src="../emoji/data.js"></script>
    <script src="tool.js"></script>
</body>
</html>